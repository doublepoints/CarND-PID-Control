# CarND-Controls-PID
Self-Driving Car Engineer Nanodegree Program

---

## Dependencies

* cmake >= 3.5
 * All OSes: [click here for installation instructions](https://cmake.org/install/)
* make >= 4.1(mac, linux), 3.81(Windows)
  * Linux: make is installed by default on most Linux distros
  * Mac: [install Xcode command line tools to get make](https://developer.apple.com/xcode/features/)
  * Windows: [Click here for installation instructions](http://gnuwin32.sourceforge.net/packages/make.htm)
* gcc/g++ >= 5.4
  * Linux: gcc / g++ is installed by default on most Linux distros
  * Mac: same deal as make - [install Xcode command line tools]((https://developer.apple.com/xcode/features/)
  * Windows: recommend using [MinGW](http://www.mingw.org/)
* [uWebSockets](https://github.com/uWebSockets/uWebSockets)
  * Run either `./install-mac.sh` or `./install-ubuntu.sh`.
  * If you install from source, checkout to commit `e94b6e1`, i.e.
    ```
    git clone https://github.com/uWebSockets/uWebSockets 
    cd uWebSockets
    git checkout e94b6e1
    ```
    Some function signatures have changed in v0.14.x. See [this PR](https://github.com/udacity/CarND-MPC-Project/pull/3) for more details.
* Simulator. You can download these from the [project intro page](https://github.com/udacity/self-driving-car-sim/releases) in the classroom.

There's an experimental patch for windows in this [PR](https://github.com/udacity/CarND-PID-Control-Project/pull/3)

## Basic Build Instructions

1. Clone this repo.
2. Make a build directory: `mkdir build && cd build`
3. Compile: `cmake .. && make`
4. Run it: `./pid`. 

## Code Style

Please (do your best to) stick to [Google's C++ style guide](https://google.github.io/styleguide/cppguide.html).
## PID controller equation
 [Kp, Ki, Kd] are the proportial, integral and differential gains, then the final gain is given by
 
	gain = -(Kp * cte + Ki * (i_error + cte) + Kd * (cte - prev_cte)
	

## Describe the effect of each of the P,I,D components.

 **1.**The P error term is proportional to cross-track error (CET) term and determines the speed of the control system response as the ratio of output response. The larger the weight Kp is, the higher speed of system response turns, and the sharper turnning the vehicle turns. However, if the proportional weight Kp is too large, the vehicle will be trpped into endless oscillating around the target trajectory.

 **2.**The I error term(defined as Ki) is proportional to both the magnitude of the CET and the duration of the CET. The integral term I accelerate the movement of the process towards target trajectory and eliminates the residual steady-state error as a bias between target trajectory and vehicle's trajectory, that occurs with a pure proportional controller. The bias may be generated by wind, systematic error and etc. in the steering system.

 **3.**The D error term is proportional to the rate of change of the CET.
 It is defined as Kd to increases the stable behavior of the vehicle by damping the oscillation of vehicle by increasing the speed of the overall control system response. Adding the D-term allows the vehicle to drive through turns on the track. Moreover, the increasment of weight Kd allows driving through turns faster. 

## How to choose the final result

In this project, the parameters is tuned by manual. 
At first, I started to experiment with P controller by settings Ki and Kd weights to zero. However, the overshooting of target trajectory doesn't allow to drive the turn. After Kp estimation, I started to add the weight Kd gradually to damp the oscillation during driving the turns. To get more stable behavior during driving in turns and be able to drive faster, I had to increase gradually Kp to increase the speed of controller response and Kd to damp the oscillations after increasing of Kp. The setup weight Ki doesn't affect the vehicle behavior because there is no any bias generated by systematic error in steering system or external factors, for example wind. 

And the result is shown below:

	Kp = 0.3
	Ki = 0.0
	Kd = 20






